## 三维图形概述

### `2D`容器中的`3D`

`WPF`中的`3D`图形内容封装在`Viewport3D`元素中，该元素可以参与二维元素结构。该图形系统将`Viewport3D`视为一个二维视觉元素，就像`WPF`中的许多其他元素一样。`Viewport3D`充当三维场景中的窗口，更准确地说，它是`3D`场景所投影到的图像。

### `3D`坐标系统

`WPF`中二维图形的坐标系将原点定位在呈现区域的左上角，x轴上的正值朝右，y轴的正值朝下。而在三维坐标系中，原点位于呈现区域的中心，x轴正值朝右，y轴的正值朝上，z轴的正值从原点朝外

![](D:\personal\rote\Media3D.assets\coordsystem-1.pngview=netframeworkdesktop-4.png)

### 3D的世界都是三角形的王国

在`3D`的世界里所有的东西都是用一系列的三角形来描述。原因是三角形是用来描述一个平面的最细微的几何体，渲染引擎能够依据每个三角形的材质以及场景中的灯光角度来计算它的颜色。其实就是三点确定一个平面，在一个平面上做计算最简单，考虑的因素最少。如果用三维控件中大于三个点来做渲染基本单位，那么如果这些点不在同一个平面的话，渲染计算是相当复杂的。

`3D`对象的表面叫做网格(`Mesh`)，一个网格是由许多`3D`点来定义的，这些点叫做顶点(`vertices`)。这些顶点通过缠绕模式(`winding pattern`)连接在一起组成一个一个的三角形(`facet`)

三角形又分为前后两面，能看到的为前面，看不到的是后面

如果三角形的三个点顺时针方向组成的面就是前面，实际上是因为正面和反面的法向量与是向量的夹角，夹角小于90说明是正面，反之是反面。

### `3D`的关键元素`Elements`

要画画总是要有个画布，类似于平面中的`Canvas`。`Viewport3D`被视为一个三维场景中的窗口，也就是可视区，更准确的说，是三维场景所投影到的画面

### 相机`Camera`

处理二维对象的开发人员习惯于将绘图基元置于二维屏幕上。当创建三维场景时，其实表达的是三维对象的二维表示形式。由于三维场景的外观会因观察者的位置不同而异，因此必须指定观察位置。为观察位置就是由相机来为三维场景指定。另一种理解三维场景在二维图上的描述方法就是，将`3D`场景投影到一个`2D`平面的表面

对比两种相机

+ `PerspectivaCamera`：可以指定不同的投影及其属性以更改观察者查看三维模型的方式
+ `OrthographiCamera`：指定三维模型到二维可视化图面上的正投影，描述了不包括透视收缩的投影

两种相机，`PerspectivaCamera`是透视相机，接近人眼看到的情况，近大远小；`OrthographiCamera`是正交相机，不存在近大远小的情况，基本上是设计界面。两个相机只是视觉效果不同

![相机设置](D:\personal\rote\Media3D.assets\coordsystem-6.pngview=netframeworkdesktop-4.png)

### 灯光

和现实生活中一样，如果没有光源，什么都看不到。

+ `AmbientLight`环境光
+ `DirectionalLight`平行光
+ `PointLight`点光源
+ `SpotLight`聚光灯

### 模型和网格基元

`Model3D` 是表示泛型 `3D `对象的抽象基类。 若要生成 `3D` 场景，需要一些要查看的对象，而且构成场景图的对象必须派生自 `Model3D`。 目前，`WPF` 支持用 `GeometryModel3D` 对几何图形进行建模。 此模型的`Geometry` 属性采用网格基元。

若要生成模型，请首先生成一个基元或网格。 `3D` 基元是单个 `3D `实体中的顶点的集合。 大多数 `3D` 系统都提供在最简单的闭合图（由三个顶点定义的三角形）上建模的基元。 由于三角形的三个点在一个平面上，因此可以继续添加三角形，以便对网格这样较为复杂的形状建模。

`WPF 3D` 系统目前提供`MeshGeometry3D` 类，使用该类可以指定任何几何图形；它目前不支持预定义的 `3D `基元（如球体和立方体）。 首先通过将三角形顶点的列表指定为 `Positions` 属性来创建 `MeshGeometry3D`。 每个顶点都指定为 `Point3D`。` WPF` 需要有关哪些顶点由哪些三角形共用的信息。 可以通过指定具有 `TriangleIndices` 属性的三角形索引列表来提供此信息。 此列表指定在 `Positions`列表中指定的点将按哪种顺序确定三角形。

### 基本的元素

展示`3D`图形的要素

+ `Viewport3D`：可视窗口，画布，最基础的元素
+ `Viewport3D.Children`：所有`3D`对象的集合
+ `Viewport3D.Camera`：相机，整个画布的属性
+ `ModelVisual3D`：在`Viewport3D.Children`中添加具体的`3D`模型

